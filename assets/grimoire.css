/* ═══════════════════════════════════════════════════════════════
 * LES CUVÉES GRIMOIRE - DARK TAVERN TRANSFORMATION
 * Phase 1: Foundation with texture overlays and atmospheric base
 * ═══════════════════════════════════════════════════════════════ */

:root {
  /* Grimoire timing values */
  --grimoire-opening-duration: 4s;
  --grimoire-page-flip-duration: 0.8s;
  --grimoire-fog-speed-1: 60s;
  --grimoire-fog-speed-2: 75s;
  --grimoire-fog-speed-3: 45s;

  /* Effect intensities */
  --grimoire-parchment-opacity: 0.15;
  --grimoire-leather-opacity: 0.2;
  --grimoire-vignette-intensity: 0.4;
}

/* ═══════════════════════════════════════════════════════════════
 * TEXTURE OVERLAYS - Parchment & Leather
 * ═══════════════════════════════════════════════════════════════ */

/* Parchment texture overlay on main content */
article::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: var(--grimoire-parchment-opacity);
  mix-blend-mode: multiply;
  border-radius: inherit;
  background-image:
    repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(139, 115, 85, 0.03) 2px,
      rgba(139, 115, 85, 0.03) 4px
    ),
    repeating-linear-gradient(
      90deg,
      transparent,
      transparent 2px,
      rgba(139, 115, 85, 0.03) 2px,
      rgba(139, 115, 85, 0.03) 4px
    );
  z-index: 1;
}

/* Leather texture overlay on navigation sidebar */
nav::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: var(--grimoire-leather-opacity);
  mix-blend-mode: multiply;
  border-radius: inherit;
  background-image:
    radial-gradient(ellipse at 20% 30%, rgba(0, 0, 0, 0.1) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 70%, rgba(0, 0, 0, 0.08) 0%, transparent 50%),
    repeating-linear-gradient(
      45deg,
      transparent,
      transparent 3px,
      rgba(0, 0, 0, 0.02) 3px,
      rgba(0, 0, 0, 0.02) 6px
    );
  z-index: 1;
}

/* Ensure nav content stays above texture overlay */
nav > * {
  position: relative;
  z-index: 2;
}

/* Hero section parchment texture */
.hero::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0.08;
  mix-blend-mode: overlay;
  border-radius: inherit;
  background-image:
    repeating-linear-gradient(
      0deg,
      transparent,
      transparent 3px,
      rgba(244, 233, 212, 0.02) 3px,
      rgba(244, 233, 212, 0.02) 6px
    );
  z-index: 1;
}

.hero-inner {
  position: relative;
  z-index: 2;
}

/* ═══════════════════════════════════════════════════════════════
 * VIGNETTE EFFECT - Subtle edge darkening
 * ═══════════════════════════════════════════════════════════════ */

body::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  opacity: var(--grimoire-vignette-intensity);
  background: radial-gradient(
    ellipse at center,
    transparent 20%,
    rgba(0, 0, 0, 0.3) 70%,
    rgba(0, 0, 0, 0.6) 100%
  );
  z-index: 100;
}

/* ═══════════════════════════════════════════════════════════════
 * ENHANCED SHADOWS & DEPTH
 * ═══════════════════════════════════════════════════════════════ */

/* Deeper shadows on content cards */
article {
  box-shadow:
    0 24px 60px rgba(0, 0, 0, 0.5),
    0 8px 24px rgba(90, 31, 44, 0.3),
    inset 0 1px 0 rgba(244, 233, 212, 0.03);
}

nav {
  box-shadow:
    0 14px 40px rgba(0, 0, 0, 0.45),
    0 4px 16px rgba(90, 31, 44, 0.25),
    inset 0 1px 0 rgba(194, 166, 117, 0.05);
}

.hero {
  box-shadow:
    0 24px 60px rgba(0, 0, 0, 0.55),
    0 8px 24px rgba(90, 31, 44, 0.35),
    inset 0 1px 0 rgba(244, 233, 212, 0.04);
}

/* Candle-flicker effect on article shadows */
@keyframes candleFlicker {
  0%, 100% {
    filter: brightness(1) drop-shadow(0 24px 60px rgba(0, 0, 0, 0.5));
  }
  25% {
    filter: brightness(1.02) drop-shadow(0 24px 62px rgba(0, 0, 0, 0.48));
  }
  50% {
    filter: brightness(0.98) drop-shadow(0 24px 58px rgba(0, 0, 0, 0.52));
  }
  75% {
    filter: brightness(1.01) drop-shadow(0 24px 61px rgba(0, 0, 0, 0.49));
  }
}

article.grimoire-flicker {
  animation: candleFlicker 3s ease-in-out infinite;
}

/* ═══════════════════════════════════════════════════════════════
 * GPU ACCELERATION SETUP
 * ═══════════════════════════════════════════════════════════════ */

/* Promote animated elements to their own layers */
.grimoire-animated {
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
}

/* ═══════════════════════════════════════════════════════════════
 * OPENING ANIMATION STRUCTURE (Phase 2)
 * Container setup - animation keyframes added in Phase 2
 * ═══════════════════════════════════════════════════════════════ */

#grimoire-opening {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #0a0708 0%, #120f12 50%, #0a0708 100%);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.6s ease-out;
}

#grimoire-opening.active {
  opacity: 1;
  pointer-events: all;
}

/* Skip button */
.grimoire-skip {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  padding: 0.6rem 1.2rem;
  border: 1px solid rgba(194, 166, 117, 0.4);
  background: rgba(0, 0, 0, 0.6);
  color: var(--parchment-0);
  font-family: "Cinzel", serif;
  font-size: 0.85rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  border-radius: 8px;
  cursor: pointer;
  opacity: 0;
  transition: all 0.3s ease;
  z-index: 10000;
}

.grimoire-skip.visible {
  opacity: 1;
}

.grimoire-skip:hover {
  background: rgba(194, 166, 117, 0.1);
  border-color: rgba(194, 166, 117, 0.6);
  transform: translateY(-2px);
}

/* Book structure */
.grimoire-book {
  position: relative;
  width: 600px;
  height: 400px;
  perspective: 2000px;
  transform-style: preserve-3d;
}

.grimoire-book-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
}

/* Book cover (front) */
.grimoire-cover-front {
  position: absolute;
  width: 50%;
  height: 100%;
  right: 0;
  background: linear-gradient(135deg, #2a1a1a 0%, #1a0f0f 100%);
  border: 2px solid rgba(90, 31, 44, 0.8);
  border-left: none;
  border-radius: 0 12px 12px 0;
  transform-origin: left center;
  transform-style: preserve-3d;
  backface-visibility: hidden;
  box-shadow:
    inset 0 0 30px rgba(0, 0, 0, 0.5),
    0 10px 40px rgba(0, 0, 0, 0.7);
}

/* Book cover decoration - Les Cuvées emblem */
.grimoire-emblem {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 120px;
  height: 120px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 3px solid var(--gold-1);
  border-radius: 50%;
  background: radial-gradient(circle, rgba(90, 31, 44, 0.3), transparent);
}

.grimoire-emblem-text {
  font-family: "Cinzel", serif;
  font-size: 1rem;
  color: var(--gold-1);
  text-align: center;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  line-height: 1.3;
}

.grimoire-emblem-symbol {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 3rem;
  color: var(--gold-1);
  opacity: 0.4;
}

/* Book pages (right side) */
.grimoire-pages-right {
  position: absolute;
  width: 50%;
  height: 100%;
  left: 0;
  background: linear-gradient(90deg, #f4e9d4 0%, #e8dbc5 100%);
  border: 1px solid rgba(139, 115, 85, 0.5);
  border-right: none;
  border-radius: 12px 0 0 12px;
  opacity: 0;
  box-shadow: inset -10px 0 20px rgba(0, 0, 0, 0.1);
}

/* Book spine */
.grimoire-spine {
  position: absolute;
  width: 40px;
  height: 100%;
  left: 50%;
  transform: translateX(-50%) rotateY(90deg);
  background: linear-gradient(180deg, #3a1a1a 0%, #2a1010 100%);
  border-top: 2px solid rgba(90, 31, 44, 0.8);
  border-bottom: 2px solid rgba(90, 31, 44, 0.8);
  transform-origin: center;
}

/* Opening animation keyframes */
@keyframes bookCoverOpen {
  0% {
    transform: rotateY(0deg);
  }
  100% {
    transform: rotateY(-165deg);
  }
}

@keyframes bookPagesReveal {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

@keyframes bookSlideOut {
  0% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(-120%, -50%) scale(0.7);
    opacity: 0;
  }
}

@keyframes containerFadeOut {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

/* Animation states */
#grimoire-opening.opening .grimoire-cover-front {
  animation: bookCoverOpen 2s cubic-bezier(0.4, 0.0, 0.2, 1) 0.5s forwards;
}

#grimoire-opening.opening .grimoire-pages-right {
  animation: bookPagesReveal 0.6s ease-out 1.8s forwards;
}

#grimoire-opening.closing .grimoire-book {
  animation: bookSlideOut 0.8s ease-in forwards;
}

#grimoire-opening.closing {
  animation: containerFadeOut 0.8s ease-out 0.4s forwards;
}

/* ═══════════════════════════════════════════════════════════════
 * FOG LAYERS (Phase 4)
 * Structure setup - animations added in Phase 4
 * ═══════════════════════════════════════════════════════════════ */

.grimoire-fog-layer {
  position: fixed;
  width: 200%;
  height: 100%;
  pointer-events: none;
  mix-blend-mode: screen;
  z-index: 50;
}

/* Individual fog layer styling with animations */
.grimoire-fog-layer-1 {
  opacity: 0.3;
  background: linear-gradient(
    45deg,
    transparent 30%,
    rgba(90, 31, 44, 0.15) 50%,
    transparent 70%
  );
  animation: fogDrift1 var(--grimoire-fog-speed-1) linear infinite;
  will-change: transform;
}

.grimoire-fog-layer-2 {
  opacity: 0.25;
  background: linear-gradient(
    -30deg,
    transparent 40%,
    rgba(194, 166, 117, 0.08) 55%,
    transparent 75%
  );
  animation: fogDrift2 var(--grimoire-fog-speed-2) linear infinite;
  will-change: transform;
}

.grimoire-fog-layer-3 {
  opacity: 0.35;
  background: linear-gradient(
    60deg,
    transparent 35%,
    rgba(90, 31, 44, 0.12) 48%,
    transparent 65%
  );
  animation: fogDrift3 var(--grimoire-fog-speed-3) linear infinite;
  will-change: transform;
}

/* Fog drift animations - slow horizontal movement */
@keyframes fogDrift1 {
  0% {
    transform: translate3d(0, 0, 0);
  }
  100% {
    transform: translate3d(-50%, 0, 0);
  }
}

@keyframes fogDrift2 {
  0% {
    transform: translate3d(-50%, 0, 0);
  }
  100% {
    transform: translate3d(0, 0, 0);
  }
}

@keyframes fogDrift3 {
  0% {
    transform: translate3d(0, -2%, 0);
  }
  50% {
    transform: translate3d(-25%, 2%, 0);
  }
  100% {
    transform: translate3d(-50%, -2%, 0);
  }
}

/* ═══════════════════════════════════════════════════════════════
 * PARTICLE EFFECTS (Phase 4)
 * Structure setup for floating dust motes
 * ═══════════════════════════════════════════════════════════════ */

.grimoire-particle {
  position: fixed;
  border-radius: 50%;
  background: rgba(244, 233, 212, 0.4);
  pointer-events: none;
  z-index: 60;
  will-change: transform, opacity;
  box-shadow: 0 0 2px rgba(244, 233, 212, 0.3);
}

/* Particle floating animations - varied durations and paths */
@keyframes particleFloat1 {
  0% {
    transform: translate3d(0, 0, 0);
    opacity: 0;
  }
  10% {
    opacity: 0.4;
  }
  90% {
    opacity: 0.4;
  }
  100% {
    transform: translate3d(-30vw, -100vh, 0);
    opacity: 0;
  }
}

@keyframes particleFloat2 {
  0% {
    transform: translate3d(0, 0, 0);
    opacity: 0;
  }
  15% {
    opacity: 0.5;
  }
  85% {
    opacity: 0.5;
  }
  100% {
    transform: translate3d(20vw, -110vh, 0);
    opacity: 0;
  }
}

@keyframes particleFloat3 {
  0% {
    transform: translate3d(0, 0, 0) rotate(0deg);
    opacity: 0;
  }
  12% {
    opacity: 0.3;
  }
  88% {
    opacity: 0.3;
  }
  100% {
    transform: translate3d(-15vw, -105vh, 0) rotate(360deg);
    opacity: 0;
  }
}

@keyframes particleFloat4 {
  0% {
    transform: translate3d(0, 0, 0);
    opacity: 0;
  }
  8% {
    opacity: 0.6;
  }
  92% {
    opacity: 0.6;
  }
  100% {
    transform: translate3d(25vw, -95vh, 0);
    opacity: 0;
  }
}

/* ═══════════════════════════════════════════════════════════════
 * VIEW TRANSITION API INTEGRATION (Phase 3)
 * Page flip animations
 * ═══════════════════════════════════════════════════════════════ */

/* View Transition root setup */
::view-transition-old(root),
::view-transition-new(root) {
  animation-duration: var(--grimoire-page-flip-duration);
  backface-visibility: hidden;
}

/* Page flip keyframes - grimoire book page turning */
@keyframes pageFlipOut {
  0% {
    transform: perspective(1200px) rotateY(0deg) translateZ(0);
    opacity: 1;
    filter: brightness(1);
  }
  50% {
    transform: perspective(1200px) rotateY(-90deg) translateZ(100px);
    opacity: 0.3;
    filter: brightness(0.7);
  }
  100% {
    transform: perspective(1200px) rotateY(-180deg) translateZ(0);
    opacity: 0;
    filter: brightness(0.5);
  }
}

@keyframes pageFlipIn {
  0% {
    transform: perspective(1200px) rotateY(180deg) translateZ(0);
    opacity: 0;
    filter: brightness(0.5);
  }
  50% {
    transform: perspective(1200px) rotateY(90deg) translateZ(100px);
    opacity: 0.3;
    filter: brightness(0.7);
  }
  100% {
    transform: perspective(1200px) rotateY(0deg) translateZ(0);
    opacity: 1;
    filter: brightness(1);
  }
}

/* Page flip animation for supported browsers */
@supports (view-transition-name: root) {
  ::view-transition-old(root) {
    animation-name: pageFlipOut;
    animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);
  }

  ::view-transition-new(root) {
    animation-name: pageFlipIn;
    animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);
  }
}

/* Fallback fade for unsupported browsers */
.grimoire-page-transition-fallback {
  animation: fadeOut 0.3s ease-out forwards;
}

@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}

/* Page number display in corners */
.grimoire-page-number {
  position: fixed;
  bottom: 2rem;
  font-family: "Cinzel", serif;
  font-size: 0.9rem;
  color: rgba(194, 166, 117, 0.6);
  letter-spacing: 0.05em;
  pointer-events: none;
  z-index: 10;
}

.grimoire-page-number-left {
  left: 2rem;
}

.grimoire-page-number-right {
  right: 2rem;
}

/* ═══════════════════════════════════════════════════════════════
 * MOBILE OPTIMIZATION
 * Disable heavy effects on smaller screens
 * ═══════════════════════════════════════════════════════════════ */

@media (max-width: 1080px) {
  /* Reduce fog opacity on tablets */
  .grimoire-fog-layer-1,
  .grimoire-fog-layer-2,
  .grimoire-fog-layer-3 {
    opacity: 0.15;
  }

  /* Reduce vignette intensity */
  body::after {
    opacity: 0.25;
  }
}

@media (max-width: 700px) {
  /* Disable fog completely on mobile */
  .grimoire-fog-layer {
    display: none;
  }

  /* Disable particles on mobile */
  .grimoire-particle {
    display: none;
  }

  /* Lighten vignette on mobile */
  body::after {
    opacity: 0.15;
  }

  /* Reduce texture intensity on mobile */
  article::after,
  nav::after {
    opacity: 0.08;
  }

  /* Skip opening animation on mobile */
  #grimoire-opening {
    display: none !important;
  }
}

/* ═══════════════════════════════════════════════════════════════
 * ACCESSIBILITY - Respect user preferences
 * ═══════════════════════════════════════════════════════════════ */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  /* Disable grimoire effects for reduced motion */
  #grimoire-opening,
  .grimoire-fog-layer,
  .grimoire-particle {
    display: none !important;
  }
}

/* ═══════════════════════════════════════════════════════════════
 * PHASE 1 COMPLETE - Foundation Ready
 * Next phases will add:
 * - Phase 2: Book opening animation keyframes
 * - Phase 3: Page flip transition keyframes
 * - Phase 4: Fog drift animations & particle floating
 * ═══════════════════════════════════════════════════════════════ */
